<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›½å®¶IPæ‹¦æˆªç³»ç»Ÿ - æœ¬åœ°æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f2f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .status.loading {
            background: #fff3cd;
            color: #856404;
        }

        .status.allowed {
            background: #d4edda;
            color: #155724;
        }

        .status.blocked {
            background: #f8d7da;
            color: #721c24;
        }

        .info-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .info-card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .info-row {
            display: flex;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #666;
            width: 200px;
        }

        .info-value {
            color: #333;
            flex: 1;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin-top: 15px;
        }

        .test-controls {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #0056b3;
        }

        .btn.danger {
            background: #dc3545;
        }

        .btn.danger:hover {
            background: #c82333;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert.info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        #console-log {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 3px 0;
        }

        .log-time {
            color: #858585;
        }

        .log-info {
            color: #4ec9b0;
        }

        .log-warn {
            color: #dcdcaa;
        }

        .log-error {
            color: #f48771;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ å›½å®¶IPæ‹¦æˆªç³»ç»Ÿ - æœ¬åœ°æµ‹è¯•é¡µé¢</h1>
            <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯• country-block.js çš„åŠŸèƒ½</p>
            <div id="status" class="status loading">æ­£åœ¨æ£€æµ‹...</div>
        </div>

        <div class="alert info">
            <strong>â„¹ï¸ è¯´æ˜ï¼š</strong>æ­¤æµ‹è¯•é¡µé¢ä¼šåŠ è½½ country-block.js å¹¶æ˜¾ç¤ºæ£€æµ‹ç»“æœã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—äº†è§£è¯¦ç»†çš„æ‰§è¡Œè¿‡ç¨‹ã€‚
        </div>

        <div class="info-card">
            <h2>æ£€æµ‹ç»“æœ</h2>
            <div class="info-row">
                <div class="info-label">æ‚¨çš„å›½å®¶ä»£ç ï¼š</div>
                <div class="info-value" id="country-code">æ£€æµ‹ä¸­...</div>
            </div>
            <div class="info-row">
                <div class="info-label">è®¿é—®çŠ¶æ€ï¼š</div>
                <div class="info-value" id="access-status">æ£€æµ‹ä¸­...</div>
            </div>
            <div class="info-row">
                <div class="info-label">æ•°æ®æ¥æºï¼š</div>
                <div class="info-value" id="data-source">æ£€æµ‹ä¸­...</div>
            </div>
            <div class="info-row">
                <div class="info-label">ç¼“å­˜çŠ¶æ€ï¼š</div>
                <div class="info-value" id="cache-status">æ£€æµ‹ä¸­...</div>
            </div>
        </div>

        <div class="test-controls">
            <h2>æµ‹è¯•æ§åˆ¶</h2>
            <button class="btn" onclick="refreshTest()">ğŸ”„ é‡æ–°æ£€æµ‹</button>
            <button class="btn" onclick="clearCache()">ğŸ—‘ï¸ æ¸…é™¤ç¼“å­˜</button>
            <button class="btn" onclick="viewLocalStorage()">ğŸ“¦ æŸ¥çœ‹ç¼“å­˜æ•°æ®</button>
            <button class="btn danger" onclick="clearConsole()">âŒ æ¸…ç©ºæ—¥å¿—</button>
        </div>

        <div class="info-card">
            <h2>æ§åˆ¶å°æ—¥å¿—</h2>
            <div id="console-log">
                <div class="log-entry log-info">[ç³»ç»Ÿ] é¡µé¢åŠ è½½å®Œæˆï¼Œç­‰å¾…æ£€æµ‹ç»“æœ...</div>
            </div>
        </div>

        <div class="alert warning">
            <strong>âš ï¸ æ³¨æ„ï¼š</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
                <li>å¦‚æœæ‚¨çš„å›½å®¶åœ¨é»‘åå•ä¸­ï¼Œé¡µé¢å°†è¢«æ‹¦æˆªå¹¶æ˜¾ç¤ºæ‹¦æˆªé¡µé¢</li>
                <li>å¦‚æœçœ‹åˆ°æ­¤é¡µé¢ï¼Œè¯´æ˜æ‚¨çš„å›½å®¶ä¸åœ¨é»‘åå•ä¸­æˆ–æ£€æµ‹å¤±è´¥ï¼ˆé»˜è®¤å…è®¸è®¿é—®ï¼‰</li>
                <li>è¯·æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æŸ¥çœ‹åŸå§‹æ§åˆ¶å°è¾“å‡º</li>
            </ul>
        </div>

        <div class="info-card">
            <h2>å½“å‰é…ç½®çš„é»‘åå•å›½å®¶</h2>
            <div id="blocked-list">åŠ è½½ä¸­...</div>
        </div>
    </div>

    <script>
        // æ•è·æ§åˆ¶å°è¾“å‡º
        const originalConsoleLog = console.log;
        const originalConsoleWarn = console.warn;
        const originalConsoleError = console.error;
        const consoleLogDiv = document.getElementById('console-log');

        function addLog(message, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.innerHTML = `<span class="log-time">[${time}]</span> ${message}`;
            consoleLogDiv.appendChild(logEntry);
            consoleLogDiv.scrollTop = consoleLogDiv.scrollHeight;
        }

        console.log = function (...args) {
            originalConsoleLog.apply(console, args);
            addLog(args.join(' '), 'info');
        };

        console.warn = function (...args) {
            originalConsoleWarn.apply(console, args);
            addLog(args.join(' '), 'warn');
        };

        console.error = function (...args) {
            originalConsoleError.apply(console, args);
            addLog(args.join(' '), 'error');
        };

        // æµ‹è¯•æ§åˆ¶å‡½æ•°
        function refreshTest() {
            location.reload();
        }

        function clearCache() {
            localStorage.removeItem('visitor_country_data');
            addLog('[æµ‹è¯•] ç¼“å­˜å·²æ¸…é™¤', 'info');
            alert('ç¼“å­˜å·²æ¸…é™¤ï¼ç‚¹å‡»"é‡æ–°æ£€æµ‹"ä»¥é‡æ–°è·å–æ•°æ®ã€‚');
        }

        function viewLocalStorage() {
            const data = localStorage.getItem('visitor_country_data');
            if (data) {
                alert('ç¼“å­˜æ•°æ®ï¼š\n\n' + JSON.stringify(JSON.parse(data), null, 2));
            } else {
                alert('æ²¡æœ‰ç¼“å­˜æ•°æ®');
            }
        }

        function clearConsole() {
            consoleLogDiv.innerHTML = '<div class="log-entry log-info">[ç³»ç»Ÿ] æ—¥å¿—å·²æ¸…ç©º</div>';
        }

        // ç›‘å¬æ£€æµ‹å®Œæˆ
        setTimeout(() => {
            const cached = localStorage.getItem('visitor_country_data');
            if (cached) {
                try {
                    const data = JSON.parse(cached);
                    document.getElementById('country-code').textContent = data.countryCode;

                    const statusDiv = document.getElementById('status');
                    statusDiv.textContent = 'âœ… å…è®¸è®¿é—®';
                    statusDiv.className = 'status allowed';

                    document.getElementById('access-status').innerHTML = '<span style="color: green;">âœ… å…è®¸</span>';
                    document.getElementById('data-source').textContent = 'IPåœ°ç†å®šä½API';

                    const cacheAge = Math.floor((Date.now() - data.timestamp) / 1000);
                    document.getElementById('cache-status').textContent = `å·²ç¼“å­˜ï¼ˆ${cacheAge}ç§’å‰ï¼‰`;

                    addLog(`[æµ‹è¯•] æ£€æµ‹å®Œæˆ - å›½å®¶ä»£ç : ${data.countryCode}`, 'info');
                    addLog('[æµ‹è¯•] è®¿é—®çŠ¶æ€: å…è®¸', 'info');
                } catch (e) {
                    addLog('[æµ‹è¯•] è§£æç¼“å­˜æ•°æ®å¤±è´¥', 'error');
                }
            } else {
                document.getElementById('country-code').textContent = 'æœªæ£€æµ‹åˆ°';
                document.getElementById('access-status').textContent = 'æœªçŸ¥';
                document.getElementById('data-source').textContent = 'APIè°ƒç”¨å¤±è´¥æˆ–æœªæ‰§è¡Œ';
                document.getElementById('cache-status').textContent = 'æ— ç¼“å­˜';

                const statusDiv = document.getElementById('status');
                statusDiv.textContent = 'âš ï¸ æ£€æµ‹å¤±è´¥';
                statusDiv.className = 'status loading';

                addLog('[æµ‹è¯•] æœªèƒ½è·å–æ£€æµ‹ç»“æœ', 'warn');
            }
        }, 2000);

        // æ˜¾ç¤ºé…ç½®çš„é»‘åå•ï¼ˆéœ€è¦æ‰‹åŠ¨æ›´æ–°ï¼‰
        document.getElementById('blocked-list').innerHTML = `
      <div class="code-block">
        å½“å‰é…ç½®çš„é»‘åå•å›½å®¶ï¼š<br>
        â€¢ CN - ä¸­å›½<br>
        â€¢ RU - ä¿„ç½—æ–¯<br>
        <br>
        <em>ï¼ˆåœ¨ country-block.js ä¸­é…ç½®ï¼‰</em>
      </div>
    `;
    </script>

    <!-- åŠ è½½æ‹¦æˆªè„šæœ¬ -->
    <script src="country-block.js"></script>
</body>

</html>